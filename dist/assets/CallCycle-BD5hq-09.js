import{j as e,r as h}from"./react-core-CwM-CeLv.js";import{H as P,V as v,W as y,C as j,a as g,b as _,e as p,i as N,d as f,L as r,I as l,B as d}from"./index-Cv1OAUNC.js";import{S as z}from"./switch-CWlgkBhQ.js";import{Z as B}from"./radix-ui-SX2QAG6c.js";import{k as x}from"./vendor-CQn7sZ7L.js";import{ad as b,al as C,am as L,R,t as Z,b as D,Z as E,n as F}from"./lucide-icons-wLPRtdhM.js";import"./supabase-r6ABpEO8.js";function H({className:m,orientation:a="horizontal",decorative:u=!0,...o}){return e.jsx(B,{"data-slot":"separator-root",decorative:u,orientation:a,className:P("bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px",m),...o})}function G({user:m}){const[a,u]=h.useState({balance_sync_interval:30,game_history_interval:60,user_status_interval:120,betting_sync_interval:45,auto_settlement_enabled:!0,settlement_interval:300,api_timeout:30,max_retry_count:3}),[o,w]=h.useState({balance_sync:{status:"running",last_run:"2024-01-20 14:30:15",next_run:"2024-01-20 14:31:15"},game_history:{status:"running",last_run:"2024-01-20 14:29:45",next_run:"2024-01-20 14:30:45"},user_status:{status:"paused",last_run:"2024-01-20 14:28:30",next_run:"2024-01-20 14:30:30"},betting_sync:{status:"running",last_run:"2024-01-20 14:30:00",next_run:"2024-01-20 14:30:45"},settlement:{status:"running",last_run:"2024-01-20 14:25:00",next_run:"2024-01-20 14:30:00"}}),[I,c]=h.useState(!1);if(!(m.level<=2))return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("h1",{children:"API 호출 주기 관리"})}),e.jsxs(v,{children:[e.jsx(b,{className:"h-4 w-4"}),e.jsx(y,{children:"이 기능은 시스템관리자 및 대본사만 접근할 수 있습니다."})]})]});const n=async(s,t)=>{c(!0);try{u(i=>({...i,[s]:t})),x.success("설정이 업데이트되었습니다.")}catch{x.error("설정 업데이트에 실패했습니다.")}finally{c(!1)}},S=async(s,t)=>{c(!0);try{w(i=>({...i,[s]:{...i[s],status:t==="start"?"running":"paused"}})),x.success(`${s} 주기가 ${t==="start"?"시작":"중지"}되었습니다.`)}catch{x.error("작업 실행에 실패했습니다.")}finally{c(!1)}},A=s=>{switch(s){case"running":return e.jsxs(d,{className:"bg-green-600",children:[e.jsx(F,{className:"h-3 w-3 mr-1"}),"실행중"]});case"paused":return e.jsxs(d,{variant:"secondary",children:[e.jsx(C,{className:"h-3 w-3 mr-1"}),"중지됨"]});case"error":return e.jsxs(d,{variant:"destructive",children:[e.jsx(b,{className:"h-3 w-3 mr-1"}),"오류"]});default:return e.jsx(d,{variant:"outline",children:"알 수 없음"})}};return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("h1",{children:"API 호출 주기 관리"}),e.jsx("p",{className:"text-muted-foreground",children:"Invest API와의 동기화 주기를 설정하고 관리합니다."})]})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:Object.entries(o).map(([s,t])=>e.jsxs(j,{children:[e.jsx(g,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(_,{className:"text-sm font-medium",children:[s==="balance_sync"&&"잔고 동기화",s==="game_history"&&"게임 기록",s==="user_status"&&"사용자 상태",s==="betting_sync"&&"베팅 동기화",s==="settlement"&&"정산 처리"]}),A(t.status)]})}),e.jsxs(p,{className:"space-y-2",children:[e.jsxs("div",{className:"text-xs text-muted-foreground",children:["마지막 실행: ",t.last_run]}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:["다음 실행: ",t.next_run]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(N,{size:"sm",variant:"outline",onClick:()=>S(s,t.status==="running"?"stop":"start"),disabled:I,children:t.status==="running"?e.jsxs(e.Fragment,{children:[e.jsx(C,{className:"h-3 w-3 mr-1"}),"중지"]}):e.jsxs(e.Fragment,{children:[e.jsx(L,{className:"h-3 w-3 mr-1"}),"시작"]})}),e.jsx(N,{size:"sm",variant:"ghost",children:e.jsx(R,{className:"h-3 w-3"})})]})]})]},s))}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(j,{children:[e.jsxs(g,{children:[e.jsxs(_,{className:"flex items-center gap-2",children:[e.jsx(Z,{className:"h-5 w-5"}),"동기화 간격 설정"]}),e.jsx(f,{children:"각 API 호출의 간격을 초 단위로 설정합니다."})]}),e.jsxs(p,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"잔고 동기화 (초)"}),e.jsx(l,{type:"number",value:a.balance_sync_interval,onChange:s=>n("balance_sync_interval",parseInt(s.target.value)),min:"10",max:"300"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"권장: 30초 이상"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"게임 기록 동기화 (초)"}),e.jsx(l,{type:"number",value:a.game_history_interval,onChange:s=>n("game_history_interval",parseInt(s.target.value)),min:"30",max:"600"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"권장: 60초 이상"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"사용자 상태 확인 (초)"}),e.jsx(l,{type:"number",value:a.user_status_interval,onChange:s=>n("user_status_interval",parseInt(s.target.value)),min:"60",max:"3600"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"베팅 동기화 (초)"}),e.jsx(l,{type:"number",value:a.betting_sync_interval,onChange:s=>n("betting_sync_interval",parseInt(s.target.value)),min:"15",max:"300"})]})]})]}),e.jsxs(j,{children:[e.jsxs(g,{children:[e.jsxs(_,{className:"flex items-center gap-2",children:[e.jsx(D,{className:"h-5 w-5"}),"고급 설정"]}),e.jsx(f,{children:"API 타임아웃 및 재시도 정책을 설정합니다."})]}),e.jsxs(p,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(r,{children:"자동 정산 활성화"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"일정 시간마다 자동으로 정산을 처리합니다."})]}),e.jsx(z,{checked:a.auto_settlement_enabled,onCheckedChange:s=>n("auto_settlement_enabled",s)})]}),a.auto_settlement_enabled&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"정산 간격 (초)"}),e.jsx(l,{type:"number",value:a.settlement_interval,onChange:s=>n("settlement_interval",parseInt(s.target.value)),min:"60",max:"3600"})]}),e.jsx(H,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"API 타임아웃 (초)"}),e.jsx(l,{type:"number",value:a.api_timeout,onChange:s=>n("api_timeout",parseInt(s.target.value)),min:"10",max:"120"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"최대 재시도 횟수"}),e.jsx(l,{type:"number",value:a.max_retry_count,onChange:s=>n("max_retry_count",parseInt(s.target.value)),min:"1",max:"10"})]})]})]})]}),e.jsxs(v,{children:[e.jsx(E,{className:"h-4 w-4"}),e.jsxs(y,{children:[e.jsx("strong",{children:"주의사항:"})," API 호출 간격을 너무 짧게 설정하면 서버에 부하를 줄 수 있습니다. 잔고 동기화는 최소 30초, 게임 기록은 최소 60초 간격을 권장합니다."]})]})]})}export{G as CallCycle,G as default};
