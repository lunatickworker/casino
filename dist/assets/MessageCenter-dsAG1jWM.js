import{j as e,r as n}from"./react-core-CwM-CeLv.js";import{o as ve,s as c,i as h,L as x,S as C,p as S,q as k,r as D,t as d,I as E,m as ye,B as Q}from"./index-B-OPgV84.js";import{T as X}from"./textarea-B58kONDf.js";import{D as Ne}from"./DataTable-Cfqx9Gu8.js";import{A as Y,f as Z,a as ee,b as se,c as te,d as ae}from"./AdminDialog-DoQjEojI.js";import{k as o}from"./vendor-CQn7sZ7L.js";import{c as U,an as B,U as _e,aq as we,s as re,K as le,ag as Ce,N as Se,n as ne,ad as ie,ao as ke,ar as De}from"./lucide-icons-D2Y5yybo.js";import"./radix-ui-SX2QAG6c.js";import"./supabase-r6ABpEO8.js";function Ie({user:_}){if(_.level>6)return e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx(U,{className:"h-12 w-12 text-yellow-500 mx-auto"}),e.jsx("p",{className:"text-muted-foreground",children:"메시지 센터는 매장 이상만 접근 가능합니다."})]})});const[ce,K]=n.useState(!0),[de,W]=n.useState([]),[i,H]=n.useState("received"),[q,oe]=n.useState("all"),[T,me]=n.useState("all"),[v,xe]=n.useState(""),[P,y]=n.useState(!1),[f,L]=n.useState(null),[pe,I]=n.useState(!1),[u,$]=n.useState([]),[F,A]=n.useState([]),[w,M]=n.useState(""),[ue,G]=n.useState(!1),[a,p]=n.useState({recipient_type:"user",recipient_username:"",broadcast_type:"single",selected_users:[],title:"",content:"",message_type:"normal"}),[R,O]=n.useState(""),{lastMessage:V,sendMessage:J}=ve();n.useEffect(()=>{const s=c.channel("messages-changes").on("postgres_changes",{event:"*",schema:"public",table:"messages"},t=>{console.log("🔔 메시지 테이블 변경 감지:",t),N()}).subscribe();return()=>{c.removeChannel(s)}},[]),n.useEffect(()=>{if(!w.trim())A(u);else{const s=u.filter(t=>t.username.toLowerCase().includes(w.toLowerCase()));A(s)}},[w,u]);const he=async()=>{try{G(!0);const s=a.recipient_type==="user"?"users":"partners",{data:t,error:l}=await c.from(s).select("id, username").order("username");if(l)throw l;$(t||[]),A(t||[]),M("")}catch(s){console.error("사용자 목록 조회 오류:",s),o.error("사용자 목록을 불러오는데 실패했습니다.")}finally{G(!1)}},N=async()=>{try{K(!0);let s=c.from("messages").select("*").order("created_at",{ascending:!1});if(i==="received"?s=s.eq("receiver_type","partner").eq("receiver_id",_.id):s=s.eq("sender_type","partner").eq("sender_id",_.id),q!=="all"&&(s=s.eq("message_type",q)),T!=="all"){const r=T==="read";s=s.eq("status",r?"read":"unread")}v&&(s=s.or(`subject.ilike.%${v}%,content.ilike.%${v}%`));const{data:t,error:l}=await s;if(l)throw l;const m=await Promise.all((t||[]).map(async r=>{const{count:g}=await c.from("messages").select("*",{count:"exact"}).eq("parent_id",r.id);let j="알 수 없음";if(r.sender_type==="user"){const{data:b}=await c.from("users").select("username").eq("id",r.sender_id).single();j=b?.username||"사용자"}else if(r.sender_type==="partner"){const{data:b}=await c.from("partners").select("username").eq("id",r.sender_id).single();j=b?.username||"관리자"}let z="알 수 없음";if(r.receiver_type==="user"){const{data:b}=await c.from("users").select("username").eq("id",r.receiver_id).single();z=b?.username||"사용자"}else if(r.receiver_type==="partner"){const{data:b}=await c.from("partners").select("username").eq("id",r.receiver_id).single();z=b?.username||"관리자"}return{id:r.id,sender_type:r.sender_type,sender_id:r.sender_id,sender_username:j,recipient_type:r.receiver_type,recipient_id:r.receiver_id,recipient_username:z,title:r.subject,content:r.content,message_type:r.message_type,is_read:r.status==="read",read_at:r.read_at,parent_message_id:r.parent_id,created_at:r.created_at,reply_count:g||0}}));W(m)}catch(s){console.error("메시지 조회 오류:",s),o.error("메시지를 불러오는데 실패했습니다.")}finally{K(!1)}},je=async s=>{try{const{error:t}=await c.from("messages").update({status:"read",read_at:new Date().toISOString()}).eq("id",s).eq("status","unread");if(t)throw t;W(l=>l.map(m=>m.id===s?{...m,is_read:!0,read_at:new Date().toISOString()}:m))}catch(t){console.error("메시지 읽음 처리 오류:",t)}},ge=async()=>{if(!a.content.trim()){o.error("메시지 내용을 입력해주세요.");return}if(a.broadcast_type==="single"&&!a.recipient_username.trim()){o.error("수신자를 입력해주세요.");return}if(a.broadcast_type==="selected"&&a.selected_users.length===0){o.error("수신자를 선택해주세요.");return}try{let s=[];if(a.broadcast_type==="single"){const r=a.recipient_type==="user"?"users":"partners",{data:g,error:j}=await c.from(r).select("id, username").eq("username",a.recipient_username.trim()).single();if(j||!g){o.error("수신자를 찾을 수 없습니다.");return}s=[g]}else if(a.broadcast_type==="selected"){const r=a.recipient_type==="user"?"users":"partners",{data:g,error:j}=await c.from(r).select("id, username").in("username",a.selected_users);if(j){o.error("수신자 조회에 실패했습니다.");return}s=g||[]}else if(a.broadcast_type==="all"){const r=a.recipient_type==="user"?"users":"partners",{data:g,error:j}=await c.from(r).select("id, username");if(j){o.error("전체 사용자 조회에 실패했습니다.");return}s=g||[]}if(s.length===0){o.error("전송할 수신자가 없습니다.");return}const t=s.map(r=>({sender_type:"partner",sender_id:_.id,receiver_type:a.recipient_type,receiver_id:r.id,subject:a.title||null,content:a.content.trim(),message_type:a.message_type})),{error:l}=await c.from("messages").insert(t);if(l)throw l;const m=s.length;o.success(`메시지가 ${m}명에게 전송되었습니다.`),J&&s.forEach(r=>{J("new_message",{recipient_type:a.recipient_type,recipient_id:r.id,title:a.title,content:a.content})}),p({recipient_type:"user",recipient_username:"",broadcast_type:"single",selected_users:[],title:"",content:"",message_type:"normal"}),I(!1),y(!1),N()}catch(s){console.error("메시지 전송 오류:",s),o.error("메시지 전송에 실패했습니다.")}},fe=async()=>{if(!f||!R.trim()){o.error("답장 내용을 입력해주세요.");return}try{const s={sender_type:"partner",sender_id:_.id,receiver_type:f.sender_type,receiver_id:f.sender_id,subject:f.title?`Re: ${f.title}`:null,content:R.trim(),message_type:"normal",parent_id:f.id},{error:t}=await c.from("messages").insert([s]);if(t)throw t;o.success("답장이 전송되었습니다."),O(""),y(!1),N()}catch(s){console.error("답장 전송 오류:",s),o.error("답장 전송에 실패했습니다.")}};n.useEffect(()=>{V&&V.type==="new_message"&&(o.info("새로운 메시지가 도착했습니다."),N())},[V]),n.useEffect(()=>{N()},[i,q,T]),n.useEffect(()=>{const s=setTimeout(()=>{v!==void 0&&N()},300);return()=>clearTimeout(s)},[v]);const be=[{key:"sender_username",title:i==="received"?"발신자":"수신자",render:(s,t)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(re,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:i==="received"?t.sender_username:t.recipient_username}),e.jsx("div",{className:"text-xs text-muted-foreground",children:i==="received"?t.sender_type:t.recipient_type})]})]})},{key:"title",title:"제목/내용",render:(s,t)=>e.jsxs("div",{className:`${!t.is_read&&i==="received"?"font-semibold":""}`,children:[e.jsx("div",{className:"text-sm",children:s||"(제목 없음)"}),e.jsx("div",{className:"text-xs text-muted-foreground truncate max-w-[300px]",children:t.content}),t.reply_count>0&&e.jsxs(Q,{variant:"outline",className:"text-xs mt-1",children:["답글 ",t.reply_count,"개"]})]})},{key:"message_type",title:"유형",render:s=>{const t={normal:{label:"일반",variant:"secondary"},system:{label:"시스템",variant:"outline"},urgent:{label:"긴급",variant:"destructive"}},l=t[s]||t.normal;return e.jsx(Q,{variant:l.variant,children:l.label})}},{key:"is_read",title:"읽음",render:(s,t)=>e.jsxs("div",{className:"flex items-center gap-1",children:[s?e.jsx(ne,{className:"h-4 w-4 text-green-600"}):e.jsx(ie,{className:"h-4 w-4 text-red-600"}),e.jsx("span",{className:"text-xs",children:s?"읽음":"안읽음"})]})},{key:"created_at",title:"날짜",render:s=>e.jsxs("div",{className:"text-sm",children:[new Date(s).toLocaleDateString("ko-KR"),e.jsx("div",{className:"text-xs text-muted-foreground",children:new Date(s).toLocaleTimeString("ko-KR")})]})},{key:"actions",title:"관리",render:(s,t)=>e.jsxs(Y,{open:P&&f?.id===t.id,onOpenChange:l=>{y(l),l?(L(t),O(""),I(!1),!t.is_read&&i==="received"&&je(t.id)):L(null)},children:[e.jsx(Z,{asChild:!0,children:e.jsxs(h,{size:"sm",variant:"outline",className:"h-8 px-3 flex items-center gap-1",children:[e.jsx(U,{className:"h-4 w-4"}),"보기"]})}),e.jsxs(ee,{className:"max-w-4xl max-h-[80vh] overflow-y-auto",children:[e.jsxs(se,{children:[e.jsxs(te,{children:[i==="received"?"받은 메시지":"보낸 메시지"," - ",t.title||"(제목 없음)"]}),e.jsxs(ae,{children:["메시지 내용을 확인하고 ",i==="received"?"답장을 작성할 수 있습니다":"전송된 메시지의 상세 정보를 확인할 수 있습니다","."]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(x,{children:"발신자"}),e.jsx("p",{className:"text-sm font-medium",children:t.sender_username})]}),e.jsxs("div",{children:[e.jsx(x,{children:"수신자"}),e.jsx("p",{className:"text-sm font-medium",children:t.recipient_username})]}),e.jsxs("div",{children:[e.jsx(x,{children:"전송일시"}),e.jsx("p",{className:"text-sm",children:new Date(t.created_at).toLocaleString("ko-KR")})]}),e.jsxs("div",{children:[e.jsx(x,{children:"메시지 유형"}),e.jsx("p",{className:"text-sm",children:t.message_type})]})]}),e.jsxs("div",{children:[e.jsx(x,{children:"메시지 내용"}),e.jsx("div",{className:"p-3 bg-muted rounded-md mt-1",children:e.jsx("p",{className:"text-sm whitespace-pre-wrap",children:t.content})})]}),i==="received"&&e.jsxs("div",{children:[e.jsx(x,{htmlFor:"reply",children:"답장 작성"}),e.jsx(X,{id:"reply",placeholder:"답장 내용을 입력하세요...",value:R,onChange:l=>O(l.target.value),rows:4,className:"mt-1"})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(h,{variant:"outline",onClick:()=>y(!1),children:"닫기"}),i==="received"&&e.jsxs(h,{onClick:fe,disabled:!R.trim(),children:[e.jsx(De,{className:"h-4 w-4 mr-2"}),"답장 보내기"]})]})]})]})]})}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-100",children:"메시지 센터"}),e.jsx("p",{className:"text-sm text-slate-400",children:"사용자와 관리자 간 1:1 메시지를 주고받습니다. (개별, 선택, 전체 전송 지원)"})]}),e.jsxs(Y,{open:P&&pe,onOpenChange:s=>{y(s),s?(I(!0),L(null),M("")):(M(""),$([]),A([]))},children:[e.jsx(Z,{asChild:!0,children:e.jsxs(h,{className:"btn-premium-primary",children:[e.jsx(B,{className:"h-4 w-4 mr-2"}),"새 메시지"]})}),e.jsxs(ee,{className:"!max-w-[mi500px,90vw)] w-[90vw] max-h-[85vh] overflow-hidden glass-card p-0 flex flex-col",children:[e.jsxs(se,{className:"pb-5 border-b border-slate-700/50 bg-gradient-to-r from-blue-500/10 to-purple-500/10 px-8 pt-6 rounded-t-lg bg-slate-900 backdrop-blur-xl flex-shrink-0",children:[e.jsxs(te,{className:"flex items-center gap-3 text-2xl text-slate-50",children:[e.jsx("div",{className:"p-2.5 bg-blue-500/20 rounded-lg",children:e.jsx(B,{className:"h-7 w-7 text-blue-400"})}),"새 메시지 작성"]}),e.jsx(ae,{className:"text-slate-300 mt-2 text-base",children:"개별, 선택, 또는 전체 사용자에게 메시지를 전송할 수 있습니다. 전송 방식을 선택하고 메시지 내용을 작성해주세요."})]}),e.jsxs("div",{className:"px-8 py-6 space-y-6 overflow-y-auto flex-1",children:[e.jsxs("div",{className:"space-y-4 p-5 border border-slate-700/50 rounded-xl bg-gradient-to-br from-slate-900/50 to-slate-800/30 shadow-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("div",{className:"h-1 w-8 bg-blue-500 rounded-full"}),e.jsx("h4",{className:"font-semibold text-slate-100",children:"전송 설정"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs(x,{htmlFor:"recipient_type",className:"text-slate-200 flex items-center gap-2",children:[e.jsx(_e,{className:"h-3.5 w-3.5 text-blue-400"}),"수신자 유형"]}),e.jsxs(C,{value:a.recipient_type,onValueChange:s=>{p(t=>({...t,recipient_type:s,recipient_username:"",selected_users:[]})),$([])},children:[e.jsx(S,{className:"h-11 bg-slate-800/50 border-slate-600 hover:border-blue-500 transition-colors",children:e.jsx(k,{})}),e.jsxs(D,{className:"bg-slate-900 border-slate-700",children:[e.jsx(d,{value:"user",children:"👤 사용자"}),e.jsx(d,{value:"partner",children:"🤝 관리자"})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(x,{htmlFor:"broadcast_type",className:"text-slate-200 flex items-center gap-2",children:[e.jsx(we,{className:"h-3.5 w-3.5 text-blue-400"}),"전송 방식"]}),e.jsxs(C,{value:a.broadcast_type,onValueChange:s=>{p(t=>({...t,broadcast_type:s,recipient_username:"",selected_users:[]})),(s==="selected"||s==="all")&&he()},children:[e.jsx(S,{className:"h-11 bg-slate-800/50 border-slate-600 hover:border-blue-500 transition-colors",children:e.jsx(k,{})}),e.jsxs(D,{className:"bg-slate-900 border-slate-700",children:[e.jsx(d,{value:"single",children:"📧 개별 전송"}),e.jsx(d,{value:"selected",children:"📬 선택 전송"}),e.jsx(d,{value:"all",children:"📢 전체 전송"})]})]})]})]})]}),a.broadcast_type==="single"&&e.jsxs("div",{className:"space-y-4 p-5 border border-slate-700/50 rounded-xl bg-gradient-to-br from-slate-900/50 to-slate-800/30 shadow-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("div",{className:"h-1 w-8 bg-green-500 rounded-full"}),e.jsx("h4",{className:"font-semibold text-slate-100",children:"수신자 정보"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(x,{htmlFor:"recipient_username",className:"text-slate-200 flex items-center gap-2",children:[e.jsx(re,{className:"h-3.5 w-3.5 text-green-400"}),"수신자 검색"]}),e.jsxs("div",{className:"relative",children:[e.jsx(le,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400 h-4 w-4"}),e.jsx(E,{id:"recipient_username",value:a.recipient_username,onChange:s=>p(t=>({...t,recipient_username:s.target.value})),placeholder:"수신자 ID를 입력하세요 (예: smcdev111)",className:"pl-9 input-premium h-11 bg-slate-800/50 border-slate-600 focus:border-green-500"})]}),e.jsx("div",{className:"p-3 bg-blue-500/10 border border-blue-500/20 rounded-lg",children:e.jsxs("p",{className:"text-xs text-blue-300 flex items-center gap-2",children:[e.jsx(Ce,{className:"h-3.5 w-3.5"}),'사용자가 많은 경우 "선택 전송"을 이용하시면 검색하여 선택할 수 있습니다.']})})]})]}),a.broadcast_type==="selected"&&e.jsxs("div",{className:"space-y-4 p-5 border border-slate-700/50 rounded-xl bg-gradient-to-br from-slate-900/50 to-slate-800/30 shadow-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("div",{className:"h-1 w-8 bg-green-500 rounded-full"}),e.jsx("h4",{className:"font-semibold text-slate-100",children:"수신자 선택"})]}),e.jsxs("div",{className:"space-y-3",children:[ue?e.jsxs("div",{className:"flex items-center justify-center p-8 text-slate-400",children:[e.jsx("div",{className:"loading-premium w-8 h-8"}),e.jsx("span",{className:"ml-3",children:"사용자 목록 로딩 중..."})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"relative",children:[e.jsx(Se,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400 h-4 w-4"}),e.jsx(E,{value:w,onChange:s=>M(s.target.value),placeholder:"사용자 ID로 검색...",className:"pl-9 input-premium"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"text-sm text-slate-300",children:[F.length,"명 표시 중 / 총 ",u.length,"명"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(h,{size:"sm",variant:"outline",onClick:()=>{const s=F.map(t=>t.username);p(t=>({...t,selected_users:Array.from(new Set([...t.selected_users,...s]))}))},className:"btn-premium-success text-xs px-2 py-1 h-7",children:"현재 페이지 전체 선택"}),e.jsx(h,{size:"sm",variant:"outline",onClick:()=>{p(s=>({...s,selected_users:[]}))},className:"text-xs px-2 py-1 h-7",children:"전체 해제"})]})]}),e.jsxs("div",{className:"max-h-64 overflow-y-auto border border-slate-600 rounded-lg bg-slate-900/50 p-3 space-y-1",children:[F.map(s=>e.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer hover:bg-slate-800/50 p-2 rounded transition-colors",children:[e.jsx("input",{type:"checkbox",checked:a.selected_users.includes(s.username),onChange:t=>{const l=s.username;t.target.checked?p(m=>({...m,selected_users:[...m.selected_users,l]})):p(m=>({...m,selected_users:m.selected_users.filter(r=>r!==l)}))},className:"rounded w-4 h-4"}),e.jsx("span",{className:"text-sm text-slate-200",children:s.username})]},s.id)),F.length===0&&e.jsx("div",{className:"text-center text-sm text-slate-500 py-8",children:w?"검색 결과가 없습니다.":"사용자가 없습니다."})]})]}),a.selected_users.length>0&&e.jsxs("div",{className:"mt-3 p-3 bg-blue-900/30 border border-blue-600/30 rounded-lg",children:[e.jsxs("div",{className:"text-sm text-blue-300 flex items-center gap-2",children:[e.jsx(ne,{className:"h-4 w-4"}),e.jsx("strong",{children:"선택된 사용자:"})," ",a.selected_users.length,"명"]}),e.jsx("div",{className:"text-xs text-blue-400 mt-2 max-h-24 overflow-y-auto",children:a.selected_users.join(", ")})]})]})]}),a.broadcast_type==="all"&&e.jsxs("div",{className:"space-y-4 p-5 border border-yellow-500/50 rounded-xl bg-gradient-to-br from-yellow-900/20 to-yellow-800/10 shadow-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("div",{className:"h-1 w-8 bg-yellow-500 rounded-full"}),e.jsx("h4",{className:"font-semibold text-slate-100",children:"전체 전송 확인"})]}),e.jsxs("div",{className:"p-4 bg-yellow-500/10 border border-yellow-500/20 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 text-yellow-300 mb-2",children:[e.jsx(ie,{className:"h-5 w-5"}),e.jsx("span",{className:"font-medium",children:"주의사항"})]}),e.jsxs("p",{className:"text-sm text-yellow-200",children:["모든 ",a.recipient_type==="user"?"사용자":"관리자","에게 메시지가 전송됩니다.",u.length>0&&e.jsxs("span",{className:"font-semibold",children:[" (총 ",u.length,"명)"]})]}),u.length>0&&u.length<=10&&e.jsxs("div",{className:"mt-2 text-xs text-yellow-300",children:["대상: ",u.map(s=>s.username).join(", ")]})]})]}),e.jsxs("div",{className:"space-y-4 p-5 border border-slate-700/50 rounded-xl bg-gradient-to-br from-slate-900/50 to-slate-800/30 shadow-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("div",{className:"h-1 w-8 bg-purple-500 rounded-full"}),e.jsx("h4",{className:"font-semibold text-slate-100",children:"메시지 내용"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(x,{htmlFor:"new_title",className:"text-slate-200 flex items-center gap-2",children:[e.jsx(ke,{className:"h-3.5 w-3.5 text-purple-400"}),"제목"]}),e.jsx(E,{id:"new_title",value:a.title,onChange:s=>p(t=>({...t,title:s.target.value})),placeholder:"메시지 제목을 입력하세요 (선택사항)",className:"input-premium h-11 bg-slate-800/50 border-slate-600 focus:border-purple-500"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(x,{htmlFor:"new_content",className:"text-slate-200 flex items-center gap-2",children:[e.jsx(U,{className:"h-3.5 w-3.5 text-purple-400"}),"내용 *"]}),e.jsx(X,{id:"new_content",value:a.content,onChange:s=>p(t=>({...t,content:s.target.value})),placeholder:"메시지 내용을 입력하세요",rows:6,className:"input-premium bg-slate-800/50 border-slate-600 focus:border-purple-500 resize-none"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(x,{htmlFor:"message_type",className:"text-slate-200",children:"메시지 유형"}),e.jsxs(C,{value:a.message_type,onValueChange:s=>p(t=>({...t,message_type:s})),children:[e.jsx(S,{className:"h-11 bg-slate-800/50 border-slate-600 hover:border-purple-500 transition-colors",children:e.jsx(k,{})}),e.jsxs(D,{className:"bg-slate-900 border-slate-700",children:[e.jsx(d,{value:"normal",children:"💬 일반"}),e.jsx(d,{value:"system",children:"⚙️ 시스템"}),e.jsx(d,{value:"urgent",children:"🚨 긴급"})]})]})]})]})]}),e.jsxs("div",{className:"flex gap-4 pt-6 border-t border-slate-700/50 px-8 pb-6 bg-slate-900 backdrop-blur-xl flex-shrink-0",children:[e.jsxs(h,{onClick:ge,disabled:!a.content.trim()||a.broadcast_type==="single"&&!a.recipient_username.trim()||a.broadcast_type==="selected"&&a.selected_users.length===0,className:"btn-premium-primary flex items-center gap-3 flex-1 h-12 text-base shadow-lg shadow-blue-500/20 hover:shadow-blue-500/40 transition-all",children:[e.jsx(B,{className:"h-5 w-5"}),"전송",a.broadcast_type==="single"&&" (1명)",a.broadcast_type==="selected"&&` (${a.selected_users.length}명)`,a.broadcast_type==="all"&&` (${u.length}명)`]}),e.jsx(h,{onClick:()=>y(!1),variant:"outline",className:"border-slate-600 hover:bg-slate-700/50 h-12 px-8 text-base",children:"취소"})]})]})]})]}),e.jsxs("div",{className:"glass-card rounded-xl p-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-6 pb-4 border-b border-slate-700/50",children:e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-semibold text-slate-100 flex items-center gap-2",children:[e.jsx(U,{className:"h-5 w-5 text-blue-400"}),"메시지 목록"]}),e.jsx("p",{className:"text-sm text-slate-400 mt-1",children:"사용자와 관리자 간 메시지를 주고받고 관리합니다. 개별, 선택, 전체 전송을 지원합니다."})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-wrap gap-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(h,{variant:i==="received"?"default":"outline",onClick:()=>H("received"),className:i==="received"?"btn-premium-primary":"",children:"받은 메시지"}),e.jsx(h,{variant:i==="sent"?"default":"outline",onClick:()=>H("sent"),className:i==="sent"?"btn-premium-primary":"",children:"보낸 메시지"})]}),e.jsx("div",{className:"flex-1 min-w-[200px]",children:e.jsxs("div",{className:"relative",children:[e.jsx(le,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400 h-4 w-4"}),e.jsx(E,{placeholder:"제목, 내용으로 검색...",value:v,onChange:s=>xe(s.target.value),className:"pl-9 input-premium"})]})}),e.jsxs(C,{value:q,onValueChange:oe,children:[e.jsx(S,{className:"w-[120px] bg-slate-800/50 border-slate-600",children:e.jsx(k,{})}),e.jsxs(D,{children:[e.jsx(d,{value:"all",children:"전체 유형"}),e.jsx(d,{value:"normal",children:"일반"}),e.jsx(d,{value:"system",children:"시스템"}),e.jsx(d,{value:"urgent",children:"긴급"})]})]}),i==="received"&&e.jsxs(C,{value:T,onValueChange:me,children:[e.jsx(S,{className:"w-[120px] bg-slate-800/50 border-slate-600",children:e.jsx(k,{})}),e.jsxs(D,{children:[e.jsx(d,{value:"all",children:"전체"}),e.jsx(d,{value:"unread",children:"안읽음"}),e.jsx(d,{value:"read",children:"읽음"})]})]})]}),ce?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx(ye,{})}):e.jsx(Ne,{data:de,columns:be,enableSearch:!1})]})]})]})}export{Ie as MessageCenter,Ie as default};
