import{j as e,r as n}from"./react-core-CwM-CeLv.js";import{o as ve,s as c,i as h,L as x,S as C,p as S,q as k,r as D,t as d,I as E,m as ye,B as Q}from"./index-B-OPgV84.js";import{T as X}from"./textarea-B58kONDf.js";import{D as Ne}from"./DataTable-Cfqx9Gu8.js";import{A as Y,f as Z,a as ee,b as se,c as te,d as ae}from"./AdminDialog-DoQjEojI.js";import{k as o}from"./vendor-CQn7sZ7L.js";import{c as U,an as B,U as _e,aq as we,s as re,K as le,ag as Ce,N as Se,n as ne,ad as ie,ao as ke,ar as De}from"./lucide-icons-D2Y5yybo.js";import"./radix-ui-SX2QAG6c.js";import"./supabase-r6ABpEO8.js";function Ie({user:_}){if(_.level>6)return e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx(U,{className:"h-12 w-12 text-yellow-500 mx-auto"}),e.jsx("p",{className:"text-muted-foreground",children:"ë©”ì‹œì§€ ì„¼í„°ëŠ” ë§¤ì¥ ì´ìƒë§Œ ì ‘ê·¼ ê°€ëŠ¥í•©ë‹ˆë‹¤."})]})});const[ce,K]=n.useState(!0),[de,W]=n.useState([]),[i,H]=n.useState("received"),[q,oe]=n.useState("all"),[T,me]=n.useState("all"),[v,xe]=n.useState(""),[P,y]=n.useState(!1),[f,L]=n.useState(null),[pe,I]=n.useState(!1),[u,$]=n.useState([]),[F,A]=n.useState([]),[w,M]=n.useState(""),[ue,G]=n.useState(!1),[a,p]=n.useState({recipient_type:"user",recipient_username:"",broadcast_type:"single",selected_users:[],title:"",content:"",message_type:"normal"}),[R,O]=n.useState(""),{lastMessage:V,sendMessage:J}=ve();n.useEffect(()=>{const s=c.channel("messages-changes").on("postgres_changes",{event:"*",schema:"public",table:"messages"},t=>{console.log("ğŸ”” ë©”ì‹œì§€ í…Œì´ë¸” ë³€ê²½ ê°ì§€:",t),N()}).subscribe();return()=>{c.removeChannel(s)}},[]),n.useEffect(()=>{if(!w.trim())A(u);else{const s=u.filter(t=>t.username.toLowerCase().includes(w.toLowerCase()));A(s)}},[w,u]);const he=async()=>{try{G(!0);const s=a.recipient_type==="user"?"users":"partners",{data:t,error:l}=await c.from(s).select("id, username").order("username");if(l)throw l;$(t||[]),A(t||[]),M("")}catch(s){console.error("ì‚¬ìš©ì ëª©ë¡ ì¡°íšŒ ì˜¤ë¥˜:",s),o.error("ì‚¬ìš©ì ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")}finally{G(!1)}},N=async()=>{try{K(!0);let s=c.from("messages").select("*").order("created_at",{ascending:!1});if(i==="received"?s=s.eq("receiver_type","partner").eq("receiver_id",_.id):s=s.eq("sender_type","partner").eq("sender_id",_.id),q!=="all"&&(s=s.eq("message_type",q)),T!=="all"){const r=T==="read";s=s.eq("status",r?"read":"unread")}v&&(s=s.or(`subject.ilike.%${v}%,content.ilike.%${v}%`));const{data:t,error:l}=await s;if(l)throw l;const m=await Promise.all((t||[]).map(async r=>{const{count:g}=await c.from("messages").select("*",{count:"exact"}).eq("parent_id",r.id);let j="ì•Œ ìˆ˜ ì—†ìŒ";if(r.sender_type==="user"){const{data:b}=await c.from("users").select("username").eq("id",r.sender_id).single();j=b?.username||"ì‚¬ìš©ì"}else if(r.sender_type==="partner"){const{data:b}=await c.from("partners").select("username").eq("id",r.sender_id).single();j=b?.username||"ê´€ë¦¬ì"}let z="ì•Œ ìˆ˜ ì—†ìŒ";if(r.receiver_type==="user"){const{data:b}=await c.from("users").select("username").eq("id",r.receiver_id).single();z=b?.username||"ì‚¬ìš©ì"}else if(r.receiver_type==="partner"){const{data:b}=await c.from("partners").select("username").eq("id",r.receiver_id).single();z=b?.username||"ê´€ë¦¬ì"}return{id:r.id,sender_type:r.sender_type,sender_id:r.sender_id,sender_username:j,recipient_type:r.receiver_type,recipient_id:r.receiver_id,recipient_username:z,title:r.subject,content:r.content,message_type:r.message_type,is_read:r.status==="read",read_at:r.read_at,parent_message_id:r.parent_id,created_at:r.created_at,reply_count:g||0}}));W(m)}catch(s){console.error("ë©”ì‹œì§€ ì¡°íšŒ ì˜¤ë¥˜:",s),o.error("ë©”ì‹œì§€ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")}finally{K(!1)}},je=async s=>{try{const{error:t}=await c.from("messages").update({status:"read",read_at:new Date().toISOString()}).eq("id",s).eq("status","unread");if(t)throw t;W(l=>l.map(m=>m.id===s?{...m,is_read:!0,read_at:new Date().toISOString()}:m))}catch(t){console.error("ë©”ì‹œì§€ ì½ìŒ ì²˜ë¦¬ ì˜¤ë¥˜:",t)}},ge=async()=>{if(!a.content.trim()){o.error("ë©”ì‹œì§€ ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.");return}if(a.broadcast_type==="single"&&!a.recipient_username.trim()){o.error("ìˆ˜ì‹ ìë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.");return}if(a.broadcast_type==="selected"&&a.selected_users.length===0){o.error("ìˆ˜ì‹ ìë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.");return}try{let s=[];if(a.broadcast_type==="single"){const r=a.recipient_type==="user"?"users":"partners",{data:g,error:j}=await c.from(r).select("id, username").eq("username",a.recipient_username.trim()).single();if(j||!g){o.error("ìˆ˜ì‹ ìë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");return}s=[g]}else if(a.broadcast_type==="selected"){const r=a.recipient_type==="user"?"users":"partners",{data:g,error:j}=await c.from(r).select("id, username").in("username",a.selected_users);if(j){o.error("ìˆ˜ì‹ ì ì¡°íšŒì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");return}s=g||[]}else if(a.broadcast_type==="all"){const r=a.recipient_type==="user"?"users":"partners",{data:g,error:j}=await c.from(r).select("id, username");if(j){o.error("ì „ì²´ ì‚¬ìš©ì ì¡°íšŒì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");return}s=g||[]}if(s.length===0){o.error("ì „ì†¡í•  ìˆ˜ì‹ ìê°€ ì—†ìŠµë‹ˆë‹¤.");return}const t=s.map(r=>({sender_type:"partner",sender_id:_.id,receiver_type:a.recipient_type,receiver_id:r.id,subject:a.title||null,content:a.content.trim(),message_type:a.message_type})),{error:l}=await c.from("messages").insert(t);if(l)throw l;const m=s.length;o.success(`ë©”ì‹œì§€ê°€ ${m}ëª…ì—ê²Œ ì „ì†¡ë˜ì—ˆìŠµë‹ˆë‹¤.`),J&&s.forEach(r=>{J("new_message",{recipient_type:a.recipient_type,recipient_id:r.id,title:a.title,content:a.content})}),p({recipient_type:"user",recipient_username:"",broadcast_type:"single",selected_users:[],title:"",content:"",message_type:"normal"}),I(!1),y(!1),N()}catch(s){console.error("ë©”ì‹œì§€ ì „ì†¡ ì˜¤ë¥˜:",s),o.error("ë©”ì‹œì§€ ì „ì†¡ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")}},fe=async()=>{if(!f||!R.trim()){o.error("ë‹µì¥ ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.");return}try{const s={sender_type:"partner",sender_id:_.id,receiver_type:f.sender_type,receiver_id:f.sender_id,subject:f.title?`Re: ${f.title}`:null,content:R.trim(),message_type:"normal",parent_id:f.id},{error:t}=await c.from("messages").insert([s]);if(t)throw t;o.success("ë‹µì¥ì´ ì „ì†¡ë˜ì—ˆìŠµë‹ˆë‹¤."),O(""),y(!1),N()}catch(s){console.error("ë‹µì¥ ì „ì†¡ ì˜¤ë¥˜:",s),o.error("ë‹µì¥ ì „ì†¡ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")}};n.useEffect(()=>{V&&V.type==="new_message"&&(o.info("ìƒˆë¡œìš´ ë©”ì‹œì§€ê°€ ë„ì°©í–ˆìŠµë‹ˆë‹¤."),N())},[V]),n.useEffect(()=>{N()},[i,q,T]),n.useEffect(()=>{const s=setTimeout(()=>{v!==void 0&&N()},300);return()=>clearTimeout(s)},[v]);const be=[{key:"sender_username",title:i==="received"?"ë°œì‹ ì":"ìˆ˜ì‹ ì",render:(s,t)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(re,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:i==="received"?t.sender_username:t.recipient_username}),e.jsx("div",{className:"text-xs text-muted-foreground",children:i==="received"?t.sender_type:t.recipient_type})]})]})},{key:"title",title:"ì œëª©/ë‚´ìš©",render:(s,t)=>e.jsxs("div",{className:`${!t.is_read&&i==="received"?"font-semibold":""}`,children:[e.jsx("div",{className:"text-sm",children:s||"(ì œëª© ì—†ìŒ)"}),e.jsx("div",{className:"text-xs text-muted-foreground truncate max-w-[300px]",children:t.content}),t.reply_count>0&&e.jsxs(Q,{variant:"outline",className:"text-xs mt-1",children:["ë‹µê¸€ ",t.reply_count,"ê°œ"]})]})},{key:"message_type",title:"ìœ í˜•",render:s=>{const t={normal:{label:"ì¼ë°˜",variant:"secondary"},system:{label:"ì‹œìŠ¤í…œ",variant:"outline"},urgent:{label:"ê¸´ê¸‰",variant:"destructive"}},l=t[s]||t.normal;return e.jsx(Q,{variant:l.variant,children:l.label})}},{key:"is_read",title:"ì½ìŒ",render:(s,t)=>e.jsxs("div",{className:"flex items-center gap-1",children:[s?e.jsx(ne,{className:"h-4 w-4 text-green-600"}):e.jsx(ie,{className:"h-4 w-4 text-red-600"}),e.jsx("span",{className:"text-xs",children:s?"ì½ìŒ":"ì•ˆì½ìŒ"})]})},{key:"created_at",title:"ë‚ ì§œ",render:s=>e.jsxs("div",{className:"text-sm",children:[new Date(s).toLocaleDateString("ko-KR"),e.jsx("div",{className:"text-xs text-muted-foreground",children:new Date(s).toLocaleTimeString("ko-KR")})]})},{key:"actions",title:"ê´€ë¦¬",render:(s,t)=>e.jsxs(Y,{open:P&&f?.id===t.id,onOpenChange:l=>{y(l),l?(L(t),O(""),I(!1),!t.is_read&&i==="received"&&je(t.id)):L(null)},children:[e.jsx(Z,{asChild:!0,children:e.jsxs(h,{size:"sm",variant:"outline",className:"h-8 px-3 flex items-center gap-1",children:[e.jsx(U,{className:"h-4 w-4"}),"ë³´ê¸°"]})}),e.jsxs(ee,{className:"max-w-4xl max-h-[80vh] overflow-y-auto",children:[e.jsxs(se,{children:[e.jsxs(te,{children:[i==="received"?"ë°›ì€ ë©”ì‹œì§€":"ë³´ë‚¸ ë©”ì‹œì§€"," - ",t.title||"(ì œëª© ì—†ìŒ)"]}),e.jsxs(ae,{children:["ë©”ì‹œì§€ ë‚´ìš©ì„ í™•ì¸í•˜ê³  ",i==="received"?"ë‹µì¥ì„ ì‘ì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤":"ì „ì†¡ëœ ë©”ì‹œì§€ì˜ ìƒì„¸ ì •ë³´ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤","."]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(x,{children:"ë°œì‹ ì"}),e.jsx("p",{className:"text-sm font-medium",children:t.sender_username})]}),e.jsxs("div",{children:[e.jsx(x,{children:"ìˆ˜ì‹ ì"}),e.jsx("p",{className:"text-sm font-medium",children:t.recipient_username})]}),e.jsxs("div",{children:[e.jsx(x,{children:"ì „ì†¡ì¼ì‹œ"}),e.jsx("p",{className:"text-sm",children:new Date(t.created_at).toLocaleString("ko-KR")})]}),e.jsxs("div",{children:[e.jsx(x,{children:"ë©”ì‹œì§€ ìœ í˜•"}),e.jsx("p",{className:"text-sm",children:t.message_type})]})]}),e.jsxs("div",{children:[e.jsx(x,{children:"ë©”ì‹œì§€ ë‚´ìš©"}),e.jsx("div",{className:"p-3 bg-muted rounded-md mt-1",children:e.jsx("p",{className:"text-sm whitespace-pre-wrap",children:t.content})})]}),i==="received"&&e.jsxs("div",{children:[e.jsx(x,{htmlFor:"reply",children:"ë‹µì¥ ì‘ì„±"}),e.jsx(X,{id:"reply",placeholder:"ë‹µì¥ ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”...",value:R,onChange:l=>O(l.target.value),rows:4,className:"mt-1"})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(h,{variant:"outline",onClick:()=>y(!1),children:"ë‹«ê¸°"}),i==="received"&&e.jsxs(h,{onClick:fe,disabled:!R.trim(),children:[e.jsx(De,{className:"h-4 w-4 mr-2"}),"ë‹µì¥ ë³´ë‚´ê¸°"]})]})]})]})]})}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-100",children:"ë©”ì‹œì§€ ì„¼í„°"}),e.jsx("p",{className:"text-sm text-slate-400",children:"ì‚¬ìš©ìì™€ ê´€ë¦¬ì ê°„ 1:1 ë©”ì‹œì§€ë¥¼ ì£¼ê³ ë°›ìŠµë‹ˆë‹¤. (ê°œë³„, ì„ íƒ, ì „ì²´ ì „ì†¡ ì§€ì›)"})]}),e.jsxs(Y,{open:P&&pe,onOpenChange:s=>{y(s),s?(I(!0),L(null),M("")):(M(""),$([]),A([]))},children:[e.jsx(Z,{asChild:!0,children:e.jsxs(h,{className:"btn-premium-primary",children:[e.jsx(B,{className:"h-4 w-4 mr-2"}),"ìƒˆ ë©”ì‹œì§€"]})}),e.jsxs(ee,{className:"!max-w-[mi500px,90vw)] w-[90vw] max-h-[85vh] overflow-hidden glass-card p-0 flex flex-col",children:[e.jsxs(se,{className:"pb-5 border-b border-slate-700/50 bg-gradient-to-r from-blue-500/10 to-purple-500/10 px-8 pt-6 rounded-t-lg bg-slate-900 backdrop-blur-xl flex-shrink-0",children:[e.jsxs(te,{className:"flex items-center gap-3 text-2xl text-slate-50",children:[e.jsx("div",{className:"p-2.5 bg-blue-500/20 rounded-lg",children:e.jsx(B,{className:"h-7 w-7 text-blue-400"})}),"ìƒˆ ë©”ì‹œì§€ ì‘ì„±"]}),e.jsx(ae,{className:"text-slate-300 mt-2 text-base",children:"ê°œë³„, ì„ íƒ, ë˜ëŠ” ì „ì²´ ì‚¬ìš©ìì—ê²Œ ë©”ì‹œì§€ë¥¼ ì „ì†¡í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì „ì†¡ ë°©ì‹ì„ ì„ íƒí•˜ê³  ë©”ì‹œì§€ ë‚´ìš©ì„ ì‘ì„±í•´ì£¼ì„¸ìš”."})]}),e.jsxs("div",{className:"px-8 py-6 space-y-6 overflow-y-auto flex-1",children:[e.jsxs("div",{className:"space-y-4 p-5 border border-slate-700/50 rounded-xl bg-gradient-to-br from-slate-900/50 to-slate-800/30 shadow-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("div",{className:"h-1 w-8 bg-blue-500 rounded-full"}),e.jsx("h4",{className:"font-semibold text-slate-100",children:"ì „ì†¡ ì„¤ì •"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs(x,{htmlFor:"recipient_type",className:"text-slate-200 flex items-center gap-2",children:[e.jsx(_e,{className:"h-3.5 w-3.5 text-blue-400"}),"ìˆ˜ì‹ ì ìœ í˜•"]}),e.jsxs(C,{value:a.recipient_type,onValueChange:s=>{p(t=>({...t,recipient_type:s,recipient_username:"",selected_users:[]})),$([])},children:[e.jsx(S,{className:"h-11 bg-slate-800/50 border-slate-600 hover:border-blue-500 transition-colors",children:e.jsx(k,{})}),e.jsxs(D,{className:"bg-slate-900 border-slate-700",children:[e.jsx(d,{value:"user",children:"ğŸ‘¤ ì‚¬ìš©ì"}),e.jsx(d,{value:"partner",children:"ğŸ¤ ê´€ë¦¬ì"})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(x,{htmlFor:"broadcast_type",className:"text-slate-200 flex items-center gap-2",children:[e.jsx(we,{className:"h-3.5 w-3.5 text-blue-400"}),"ì „ì†¡ ë°©ì‹"]}),e.jsxs(C,{value:a.broadcast_type,onValueChange:s=>{p(t=>({...t,broadcast_type:s,recipient_username:"",selected_users:[]})),(s==="selected"||s==="all")&&he()},children:[e.jsx(S,{className:"h-11 bg-slate-800/50 border-slate-600 hover:border-blue-500 transition-colors",children:e.jsx(k,{})}),e.jsxs(D,{className:"bg-slate-900 border-slate-700",children:[e.jsx(d,{value:"single",children:"ğŸ“§ ê°œë³„ ì „ì†¡"}),e.jsx(d,{value:"selected",children:"ğŸ“¬ ì„ íƒ ì „ì†¡"}),e.jsx(d,{value:"all",children:"ğŸ“¢ ì „ì²´ ì „ì†¡"})]})]})]})]})]}),a.broadcast_type==="single"&&e.jsxs("div",{className:"space-y-4 p-5 border border-slate-700/50 rounded-xl bg-gradient-to-br from-slate-900/50 to-slate-800/30 shadow-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("div",{className:"h-1 w-8 bg-green-500 rounded-full"}),e.jsx("h4",{className:"font-semibold text-slate-100",children:"ìˆ˜ì‹ ì ì •ë³´"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(x,{htmlFor:"recipient_username",className:"text-slate-200 flex items-center gap-2",children:[e.jsx(re,{className:"h-3.5 w-3.5 text-green-400"}),"ìˆ˜ì‹ ì ê²€ìƒ‰"]}),e.jsxs("div",{className:"relative",children:[e.jsx(le,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400 h-4 w-4"}),e.jsx(E,{id:"recipient_username",value:a.recipient_username,onChange:s=>p(t=>({...t,recipient_username:s.target.value})),placeholder:"ìˆ˜ì‹ ì IDë¥¼ ì…ë ¥í•˜ì„¸ìš” (ì˜ˆ: smcdev111)",className:"pl-9 input-premium h-11 bg-slate-800/50 border-slate-600 focus:border-green-500"})]}),e.jsx("div",{className:"p-3 bg-blue-500/10 border border-blue-500/20 rounded-lg",children:e.jsxs("p",{className:"text-xs text-blue-300 flex items-center gap-2",children:[e.jsx(Ce,{className:"h-3.5 w-3.5"}),'ì‚¬ìš©ìê°€ ë§ì€ ê²½ìš° "ì„ íƒ ì „ì†¡"ì„ ì´ìš©í•˜ì‹œë©´ ê²€ìƒ‰í•˜ì—¬ ì„ íƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.']})})]})]}),a.broadcast_type==="selected"&&e.jsxs("div",{className:"space-y-4 p-5 border border-slate-700/50 rounded-xl bg-gradient-to-br from-slate-900/50 to-slate-800/30 shadow-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("div",{className:"h-1 w-8 bg-green-500 rounded-full"}),e.jsx("h4",{className:"font-semibold text-slate-100",children:"ìˆ˜ì‹ ì ì„ íƒ"})]}),e.jsxs("div",{className:"space-y-3",children:[ue?e.jsxs("div",{className:"flex items-center justify-center p-8 text-slate-400",children:[e.jsx("div",{className:"loading-premium w-8 h-8"}),e.jsx("span",{className:"ml-3",children:"ì‚¬ìš©ì ëª©ë¡ ë¡œë”© ì¤‘..."})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"relative",children:[e.jsx(Se,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400 h-4 w-4"}),e.jsx(E,{value:w,onChange:s=>M(s.target.value),placeholder:"ì‚¬ìš©ì IDë¡œ ê²€ìƒ‰...",className:"pl-9 input-premium"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"text-sm text-slate-300",children:[F.length,"ëª… í‘œì‹œ ì¤‘ / ì´ ",u.length,"ëª…"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(h,{size:"sm",variant:"outline",onClick:()=>{const s=F.map(t=>t.username);p(t=>({...t,selected_users:Array.from(new Set([...t.selected_users,...s]))}))},className:"btn-premium-success text-xs px-2 py-1 h-7",children:"í˜„ì¬ í˜ì´ì§€ ì „ì²´ ì„ íƒ"}),e.jsx(h,{size:"sm",variant:"outline",onClick:()=>{p(s=>({...s,selected_users:[]}))},className:"text-xs px-2 py-1 h-7",children:"ì „ì²´ í•´ì œ"})]})]}),e.jsxs("div",{className:"max-h-64 overflow-y-auto border border-slate-600 rounded-lg bg-slate-900/50 p-3 space-y-1",children:[F.map(s=>e.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer hover:bg-slate-800/50 p-2 rounded transition-colors",children:[e.jsx("input",{type:"checkbox",checked:a.selected_users.includes(s.username),onChange:t=>{const l=s.username;t.target.checked?p(m=>({...m,selected_users:[...m.selected_users,l]})):p(m=>({...m,selected_users:m.selected_users.filter(r=>r!==l)}))},className:"rounded w-4 h-4"}),e.jsx("span",{className:"text-sm text-slate-200",children:s.username})]},s.id)),F.length===0&&e.jsx("div",{className:"text-center text-sm text-slate-500 py-8",children:w?"ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.":"ì‚¬ìš©ìê°€ ì—†ìŠµë‹ˆë‹¤."})]})]}),a.selected_users.length>0&&e.jsxs("div",{className:"mt-3 p-3 bg-blue-900/30 border border-blue-600/30 rounded-lg",children:[e.jsxs("div",{className:"text-sm text-blue-300 flex items-center gap-2",children:[e.jsx(ne,{className:"h-4 w-4"}),e.jsx("strong",{children:"ì„ íƒëœ ì‚¬ìš©ì:"})," ",a.selected_users.length,"ëª…"]}),e.jsx("div",{className:"text-xs text-blue-400 mt-2 max-h-24 overflow-y-auto",children:a.selected_users.join(", ")})]})]})]}),a.broadcast_type==="all"&&e.jsxs("div",{className:"space-y-4 p-5 border border-yellow-500/50 rounded-xl bg-gradient-to-br from-yellow-900/20 to-yellow-800/10 shadow-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("div",{className:"h-1 w-8 bg-yellow-500 rounded-full"}),e.jsx("h4",{className:"font-semibold text-slate-100",children:"ì „ì²´ ì „ì†¡ í™•ì¸"})]}),e.jsxs("div",{className:"p-4 bg-yellow-500/10 border border-yellow-500/20 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 text-yellow-300 mb-2",children:[e.jsx(ie,{className:"h-5 w-5"}),e.jsx("span",{className:"font-medium",children:"ì£¼ì˜ì‚¬í•­"})]}),e.jsxs("p",{className:"text-sm text-yellow-200",children:["ëª¨ë“  ",a.recipient_type==="user"?"ì‚¬ìš©ì":"ê´€ë¦¬ì","ì—ê²Œ ë©”ì‹œì§€ê°€ ì „ì†¡ë©ë‹ˆë‹¤.",u.length>0&&e.jsxs("span",{className:"font-semibold",children:[" (ì´ ",u.length,"ëª…)"]})]}),u.length>0&&u.length<=10&&e.jsxs("div",{className:"mt-2 text-xs text-yellow-300",children:["ëŒ€ìƒ: ",u.map(s=>s.username).join(", ")]})]})]}),e.jsxs("div",{className:"space-y-4 p-5 border border-slate-700/50 rounded-xl bg-gradient-to-br from-slate-900/50 to-slate-800/30 shadow-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("div",{className:"h-1 w-8 bg-purple-500 rounded-full"}),e.jsx("h4",{className:"font-semibold text-slate-100",children:"ë©”ì‹œì§€ ë‚´ìš©"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(x,{htmlFor:"new_title",className:"text-slate-200 flex items-center gap-2",children:[e.jsx(ke,{className:"h-3.5 w-3.5 text-purple-400"}),"ì œëª©"]}),e.jsx(E,{id:"new_title",value:a.title,onChange:s=>p(t=>({...t,title:s.target.value})),placeholder:"ë©”ì‹œì§€ ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš” (ì„ íƒì‚¬í•­)",className:"input-premium h-11 bg-slate-800/50 border-slate-600 focus:border-purple-500"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(x,{htmlFor:"new_content",className:"text-slate-200 flex items-center gap-2",children:[e.jsx(U,{className:"h-3.5 w-3.5 text-purple-400"}),"ë‚´ìš© *"]}),e.jsx(X,{id:"new_content",value:a.content,onChange:s=>p(t=>({...t,content:s.target.value})),placeholder:"ë©”ì‹œì§€ ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”",rows:6,className:"input-premium bg-slate-800/50 border-slate-600 focus:border-purple-500 resize-none"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(x,{htmlFor:"message_type",className:"text-slate-200",children:"ë©”ì‹œì§€ ìœ í˜•"}),e.jsxs(C,{value:a.message_type,onValueChange:s=>p(t=>({...t,message_type:s})),children:[e.jsx(S,{className:"h-11 bg-slate-800/50 border-slate-600 hover:border-purple-500 transition-colors",children:e.jsx(k,{})}),e.jsxs(D,{className:"bg-slate-900 border-slate-700",children:[e.jsx(d,{value:"normal",children:"ğŸ’¬ ì¼ë°˜"}),e.jsx(d,{value:"system",children:"âš™ï¸ ì‹œìŠ¤í…œ"}),e.jsx(d,{value:"urgent",children:"ğŸš¨ ê¸´ê¸‰"})]})]})]})]})]}),e.jsxs("div",{className:"flex gap-4 pt-6 border-t border-slate-700/50 px-8 pb-6 bg-slate-900 backdrop-blur-xl flex-shrink-0",children:[e.jsxs(h,{onClick:ge,disabled:!a.content.trim()||a.broadcast_type==="single"&&!a.recipient_username.trim()||a.broadcast_type==="selected"&&a.selected_users.length===0,className:"btn-premium-primary flex items-center gap-3 flex-1 h-12 text-base shadow-lg shadow-blue-500/20 hover:shadow-blue-500/40 transition-all",children:[e.jsx(B,{className:"h-5 w-5"}),"ì „ì†¡",a.broadcast_type==="single"&&" (1ëª…)",a.broadcast_type==="selected"&&` (${a.selected_users.length}ëª…)`,a.broadcast_type==="all"&&` (${u.length}ëª…)`]}),e.jsx(h,{onClick:()=>y(!1),variant:"outline",className:"border-slate-600 hover:bg-slate-700/50 h-12 px-8 text-base",children:"ì·¨ì†Œ"})]})]})]})]}),e.jsxs("div",{className:"glass-card rounded-xl p-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-6 pb-4 border-b border-slate-700/50",children:e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-semibold text-slate-100 flex items-center gap-2",children:[e.jsx(U,{className:"h-5 w-5 text-blue-400"}),"ë©”ì‹œì§€ ëª©ë¡"]}),e.jsx("p",{className:"text-sm text-slate-400 mt-1",children:"ì‚¬ìš©ìì™€ ê´€ë¦¬ì ê°„ ë©”ì‹œì§€ë¥¼ ì£¼ê³ ë°›ê³  ê´€ë¦¬í•©ë‹ˆë‹¤. ê°œë³„, ì„ íƒ, ì „ì²´ ì „ì†¡ì„ ì§€ì›í•©ë‹ˆë‹¤."})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-wrap gap-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(h,{variant:i==="received"?"default":"outline",onClick:()=>H("received"),className:i==="received"?"btn-premium-primary":"",children:"ë°›ì€ ë©”ì‹œì§€"}),e.jsx(h,{variant:i==="sent"?"default":"outline",onClick:()=>H("sent"),className:i==="sent"?"btn-premium-primary":"",children:"ë³´ë‚¸ ë©”ì‹œì§€"})]}),e.jsx("div",{className:"flex-1 min-w-[200px]",children:e.jsxs("div",{className:"relative",children:[e.jsx(le,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400 h-4 w-4"}),e.jsx(E,{placeholder:"ì œëª©, ë‚´ìš©ìœ¼ë¡œ ê²€ìƒ‰...",value:v,onChange:s=>xe(s.target.value),className:"pl-9 input-premium"})]})}),e.jsxs(C,{value:q,onValueChange:oe,children:[e.jsx(S,{className:"w-[120px] bg-slate-800/50 border-slate-600",children:e.jsx(k,{})}),e.jsxs(D,{children:[e.jsx(d,{value:"all",children:"ì „ì²´ ìœ í˜•"}),e.jsx(d,{value:"normal",children:"ì¼ë°˜"}),e.jsx(d,{value:"system",children:"ì‹œìŠ¤í…œ"}),e.jsx(d,{value:"urgent",children:"ê¸´ê¸‰"})]})]}),i==="received"&&e.jsxs(C,{value:T,onValueChange:me,children:[e.jsx(S,{className:"w-[120px] bg-slate-800/50 border-slate-600",children:e.jsx(k,{})}),e.jsxs(D,{children:[e.jsx(d,{value:"all",children:"ì „ì²´"}),e.jsx(d,{value:"unread",children:"ì•ˆì½ìŒ"}),e.jsx(d,{value:"read",children:"ì½ìŒ"})]})]})]}),ce?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx(ye,{})}):e.jsx(Ne,{data:de,columns:be,enableSearch:!1})]})]})]})}export{Ie as MessageCenter,Ie as default};
