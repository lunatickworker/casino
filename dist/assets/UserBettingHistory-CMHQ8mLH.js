import{r as j,j as e}from"./react-core-CwM-CeLv.js";import{C as c,a as o,b as i,e as d,i as $,B as m,s as B}from"./index-Cn1S8-JW.js";import{k as T}from"./vendor-CQn7sZ7L.js";import{G as N,T as A,i as U,R as g}from"./lucide-icons-wLPRtdhM.js";import"./radix-ui-SX2QAG6c.js";import"./supabase-r6ABpEO8.js";function H({user:h}){const[p,u]=j.useState(!0),[n,f]=j.useState([]),w=t=>{if(!t)return"-";const s=new Date(t),a=s.getUTCFullYear(),x=String(s.getUTCMonth()+1).padStart(2,"0"),v=String(s.getUTCDate()).padStart(2,"0"),C=String(s.getUTCHours()).padStart(2,"0"),S=String(s.getUTCMinutes()).padStart(2,"0"),_=String(s.getUTCSeconds()).padStart(2,"0");return`${a}년${x}월${v}일 ${C}:${S}:${_}`},r=t=>new Intl.NumberFormat("ko-KR").format(t||0),y=async()=>{try{u(!0),console.log("🎮 베팅내역 조회 시작:",h.username);const{data:t,error:s}=await B.from("game_records").select("*").eq("username",h.username).order("played_at",{ascending:!1}).limit(100);if(s)throw console.error("❌ 조회 실패:",s),s;console.log("✅ 조회 성공:",t?.length||0,"건"),f(t||[])}catch(t){console.error("❌ 에러:",t),T.error("베팅 내역을 불러올 수 없습니다")}finally{u(!1)}};j.useEffect(()=>{y()},[h.username]);const l={totalBets:n.length,totalBetAmount:n.reduce((t,s)=>t+(Number(s.bet_amount)||0),0),totalWinAmount:n.reduce((t,s)=>t+(Number(s.win_amount)||0),0)};l.netProfit=l.totalWinAmount-l.totalBetAmount;const b=(t,s)=>{const a=s-t;return a>0?e.jsx(m,{className:"bg-green-600",children:"승리"}):a<0?e.jsx(m,{className:"bg-red-600",children:"패배"}):e.jsx(m,{variant:"secondary",children:"무승부"})};return e.jsxs("div",{className:"space-y-4 p-4 md:p-6",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[e.jsxs(c,{className:"luxury-card",children:[e.jsx(o,{className:"pb-2",children:e.jsxs(i,{className:"text-xs text-yellow-400 flex items-center gap-1",children:[e.jsx(N,{className:"w-3 h-3"}),"총 베팅"]})}),e.jsx(d,{children:e.jsxs("div",{className:"text-xl font-bold text-yellow-100",children:[l.totalBets,"건"]})})]}),e.jsxs(c,{className:"luxury-card",children:[e.jsx(o,{className:"pb-2",children:e.jsx(i,{className:"text-xs text-yellow-400",children:"총 베팅액"})}),e.jsx(d,{children:e.jsxs("div",{className:"text-xl font-bold text-blue-400",children:["₩",r(l.totalBetAmount)]})})]}),e.jsxs(c,{className:"luxury-card",children:[e.jsx(o,{className:"pb-2",children:e.jsxs(i,{className:"text-xs text-yellow-400 flex items-center gap-1",children:[e.jsx(A,{className:"w-3 h-3"}),"총 당첨액"]})}),e.jsx(d,{children:e.jsxs("div",{className:"text-xl font-bold text-green-400",children:["₩",r(l.totalWinAmount)]})})]}),e.jsxs(c,{className:"luxury-card",children:[e.jsx(o,{className:"pb-2",children:e.jsxs(i,{className:"text-xs text-yellow-400 flex items-center gap-1",children:[e.jsx(U,{className:"w-3 h-3"}),"순손익"]})}),e.jsx(d,{children:e.jsxs("div",{className:`text-xl font-bold ${l.netProfit>=0?"text-green-400":"text-red-400"}`,children:[l.netProfit>=0?"+":"","₩",r(l.netProfit)]})})]})]}),e.jsxs(c,{className:"luxury-card",children:[e.jsx(o,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx(i,{className:"gold-text",children:"베팅 내역"}),e.jsx("p",{className:"text-xs text-yellow-200/70 mt-1",children:"최근 100건"})]}),e.jsxs($,{onClick:y,disabled:p,variant:"outline",size:"sm",className:"border-yellow-600/30 hover:bg-yellow-900/20",children:[e.jsx(g,{className:`h-4 w-4 mr-2 ${p?"animate-spin":""}`}),"새로고침"]})]})}),e.jsx(d,{children:p?e.jsx("div",{className:"flex justify-center items-center py-20",children:e.jsxs("div",{className:"text-center",children:[e.jsx(g,{className:"w-8 h-8 animate-spin mx-auto mb-4 text-yellow-400"}),e.jsx("p",{className:"text-yellow-200",children:"로딩 중..."})]})}):n.length===0?e.jsxs("div",{className:"text-center py-20",children:[e.jsx(N,{className:"w-16 h-16 mx-auto mb-4 text-yellow-600/50"}),e.jsx("p",{className:"text-yellow-200/70 text-lg",children:"베팅 내역이 없습니다"}),e.jsx("p",{className:"text-yellow-200/50 text-sm mt-2",children:"게임을 플레이하면 기록이 표시됩니다"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-yellow-600/30",children:[e.jsx("th",{className:"px-3 py-3 text-left text-xs text-yellow-400",children:"상태"}),e.jsx("th",{className:"px-3 py-3 text-left text-xs text-yellow-400",children:"게임명"}),e.jsx("th",{className:"px-3 py-3 text-left text-xs text-yellow-400",children:"제공사"}),e.jsx("th",{className:"px-3 py-3 text-right text-xs text-yellow-400",children:"베팅액"}),e.jsx("th",{className:"px-3 py-3 text-right text-xs text-yellow-400",children:"당첨액"}),e.jsx("th",{className:"px-3 py-3 text-right text-xs text-yellow-400",children:"손익"}),e.jsx("th",{className:"px-3 py-3 text-left text-xs text-yellow-400",children:"플레이 시간"})]})}),e.jsx("tbody",{children:n.map(t=>{const s=Number(t.bet_amount)||0,a=Number(t.win_amount)||0,x=a-s;return e.jsxs("tr",{className:"border-b border-yellow-600/10 hover:bg-yellow-900/10 transition-colors",children:[e.jsx("td",{className:"px-3 py-3",children:b(s,a)}),e.jsx("td",{className:"px-3 py-3 text-yellow-100 text-sm max-w-[150px] truncate",children:t.game_title||`Game ${t.game_id}`}),e.jsx("td",{className:"px-3 py-3",children:e.jsx(m,{variant:"secondary",className:"text-xs",children:t.provider_name||`Provider ${t.provider_id}`})}),e.jsxs("td",{className:"px-3 py-3 text-right font-mono text-sm text-blue-400",children:["₩",r(s)]}),e.jsxs("td",{className:"px-3 py-3 text-right font-mono text-sm text-green-400",children:["₩",r(a)]}),e.jsxs("td",{className:`px-3 py-3 text-right font-mono text-sm ${x>=0?"text-green-400":"text-red-400"}`,children:[x>=0?"+":"","₩",r(x)]}),e.jsx("td",{className:"px-3 py-3 text-yellow-100 text-xs",children:w(t.played_at)})]},t.id)})})]})})})]})]})}export{H as UserBettingHistory};
