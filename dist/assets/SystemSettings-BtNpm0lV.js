import{k as xe,r as c,s as o,t as i,j as e,w as N,R as he,m as pe,n as ue,o as A,p as D,C as b,a as k,b as C,aG as _e,d as E,e as S,E as r,I as n,U as Q,S as ge,x as je,y as fe,z as ve,D as ye,B as F,O as R,A as Ne}from"./index-DHLZKrSC.js";import{S as I}from"./switch-BbjhPU4a.js";import{S as L}from"./save-DHB__jBH.js";import{S as we}from"./search-DGG3ycOS.js";import{P as be}from"./plus-Co1dk4Al.js";import{T as ke}from"./trash-2-krsq29sW.js";import{C as Ce}from"./circle-alert-CfjAz5vG.js";import{M as Se}from"./monitor-DDJCvIq7.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ie=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],X=xe("globe",Ie);function We({user:f,initialTab:O="general"}){const[Y,U]=c.useState(O),[Pe,Z]=c.useState([]),[m,ee]=c.useState(null),[Fe,V]=c.useState(!1),[g,T]=c.useState(!1),[x,h]=c.useState({system_name:"GMS 통합 관리 시스템",notification_sound:!0,auto_approval_limit:1e5,maintenance_mode:!1,api_sync_interval:30,session_timeout:1800,max_login_attempts:5,max_concurrent_image_downloads:1}),[j,v]=c.useState({default_rolling_commission:.5,default_losing_commission:5,default_withdrawal_fee:1,min_withdrawal_amount:1e4,max_withdrawal_amount:1e6,daily_withdrawal_limit:5e6}),[p,y]=c.useState({password_min_length:8,password_require_special:!0,ip_whitelist_enabled:!1,two_factor_enabled:!1,login_log_retention_days:90,audit_log_enabled:!0}),[w,M]=c.useState([]),[q,$]=c.useState(""),[se,te]=c.useState([]),[ae,re]=c.useState(""),[l,B]=c.useState(null),[u,P]=c.useState({commission_rolling:0,commission_losing:0,withdrawal_fee:0});c.useEffect(()=>{J(),W(),ie(),H();const s=setInterval(W,3e4);return()=>clearInterval(s)},[f.level]),c.useEffect(()=>{U(O)},[O]);const J=async()=>{V(!0);try{const{data:s,error:t}=await o.from("system_settings").select("*").order("setting_key");if(t)throw t;Z(s||[]),s?.forEach(a=>{const _=le(a);a.setting_key in x?h(d=>({...d,[a.setting_key]:_})):a.setting_key in j?v(d=>({...d,[a.setting_key]:_})):a.setting_key in p&&y(d=>({...d,[a.setting_key]:_}))})}catch(s){console.error("설정 로드 실패:",s),i.error("시스템 설정을 불러오는데 실패했습니다.")}finally{V(!1)}},W=async()=>{try{const{error:s}=await o.from("partners").select("count",{count:"exact",head:!0}),{data:t}=await o.from("user_sessions").select("count",{count:"exact",head:!0}).eq("is_active",!0);ee({database_status:s?"disconnected":"connected",api_status:"active",websocket_status:"connected",active_users:t?.length||0,system_uptime:"2일 14시간 32분",memory_usage:Math.floor(Math.random()*40)+40,cpu_usage:Math.floor(Math.random()*30)+10,last_backup:new Date(Date.now()-Math.random()*864e5).toLocaleString("ko-KR")})}catch(s){console.error("시스템 정보 로드 실패:",s)}},le=s=>{switch(s.setting_type){case"boolean":return s.setting_value==="true";case"number":return parseFloat(s.setting_value);default:return s.setting_value}},z=async(s,t)=>{T(!0);try{const a=Object.entries(t).map(([_,d])=>({setting_key:_,setting_value:d.toString(),setting_type:typeof d=="boolean"?"boolean":typeof d=="number"?"number":"string",partner_level:f.level}));for(const _ of a){const{error:d}=await o.from("system_settings").upsert(_,{onConflict:"setting_key"});if(d)throw d}i.success(`${s} 설정이 성공적으로 저장되었습니다.`),await J()}catch(a){console.error("설정 저장 실패:",a),i.error("설정 저장에 실패했습니다.")}finally{T(!1)}},ie=async()=>{try{const{data:s,error:t}=await o.from("system_settings").select("setting_value").eq("setting_key","ip_whitelist").single();if(t&&t.code!=="PGRST116")throw t;if(s?.setting_value)try{const a=JSON.parse(s.setting_value);M(Array.isArray(a)?a:[])}catch{M([])}}catch(s){console.error("IP 화이트리스트 로드 실패:",s)}},K=async()=>{if(!/^(\d{1,3}\.){3}\d{1,3}$/.test(q.trim())){i.error("올바른 IP 주소 형식이 아닙니다. (예: 192.168.1.1)");return}if(w.includes(q.trim())){i.error("이미 등록된 IP 주소입니다.");return}try{const t=[...w,q.trim()],{error:a}=await o.from("system_settings").upsert({setting_key:"ip_whitelist",setting_value:JSON.stringify(t),setting_type:"json",partner_level:f.level,description:"IP 화이트리스트"},{onConflict:"setting_key"});if(a)throw a;M(t),$(""),i.success("IP 주소가 추가되었습니다.")}catch(t){console.error("IP 추가 실패:",t),i.error("IP 주소 추가에 실패했습니다.")}},ne=async s=>{try{const t=w.filter(_=>_!==s),{error:a}=await o.from("system_settings").upsert({setting_key:"ip_whitelist",setting_value:JSON.stringify(t),setting_type:"json",partner_level:f.level,description:"IP 화이트리스트"},{onConflict:"setting_key"});if(a)throw a;M(t),i.success("IP 주소가 삭제되었습니다.")}catch(t){console.error("IP 삭제 실패:",t),i.error("IP 주소 삭제에 실패했습니다.")}},H=async()=>{try{let s=o.from("partners").select("*").order("level",{ascending:!0}).order("created_at",{ascending:!1});f.level>1&&(s=s.eq("parent_id",f.id));const{data:t,error:a}=await s;if(a)throw a;te(t||[])}catch(s){console.error("파트너 목록 로드 실패:",s)}},ce=async s=>{try{const{data:t,error:a}=await o.from("partners").select("*").eq("id",s).single();if(a)throw a;t&&(B(t),P({commission_rolling:t.commission_rolling||0,commission_losing:t.commission_losing||0,withdrawal_fee:t.withdrawal_fee||0}))}catch(t){console.error("파트너 커미션 로드 실패:",t),i.error("파트너 정보를 불러오는데 실패했습니다.")}},de=s=>{re(s),s?ce(s):(B(null),P({commission_rolling:0,commission_losing:0,withdrawal_fee:0}))},oe=(s,t,a)=>l?l.partner_type==="head_office"?s!==100||t!==100||a!==100?(i.error("대본사의 커미션은 100%로 고정됩니다."),!1):!0:s>100||t>100||a>100?(i.error("커미션은 100%를 초과할 수 없습니다."),!1):s<0||t<0||a<0?(i.error("커미션은 0% 미만일 수 없습니다."),!1):!0:!1,me=async()=>{if(!l){i.error("파트너를 선택해주세요.");return}if(oe(u.commission_rolling,u.commission_losing,u.withdrawal_fee)){T(!0);try{const{error:s}=await o.from("partners").update({commission_rolling:u.commission_rolling,commission_losing:u.commission_losing,withdrawal_fee:u.withdrawal_fee,updated_at:new Date().toISOString()}).eq("id",l.id);if(s)throw s;i.success(`${l.nickname} 파트너의 커미션이 수정되었습니다.`),H()}catch(s){console.error("파트너 커미션 저장 실패:",s),i.error("커미션 저장에 실패했습니다.")}finally{T(!1)}}},G=({status:s,label:t})=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`h-3 w-3 rounded-full ${s==="connected"||s==="active"?"bg-green-500":"bg-red-500"}`}),e.jsx("span",{className:"text-sm font-medium",children:t}),e.jsx(F,{variant:s==="connected"||s==="active"?"default":"destructive",children:s==="connected"||s==="active"?"정상":"오류"})]});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-100",children:"시스템 설정"}),e.jsx("p",{className:"text-sm text-slate-400",children:"시스템 전반적인 설정을 관리하고 상태를 모니터링합니다."})]}),e.jsx("div",{className:"flex gap-2",children:e.jsxs(N,{onClick:W,variant:"outline",size:"sm",children:[e.jsx(he,{className:"h-4 w-4 mr-2"}),"새로고침"]})})]}),e.jsxs(pe,{value:Y,onValueChange:U,children:[e.jsxs(ue,{className:"grid w-full grid-cols-4 bg-slate-900/50 p-1 border border-slate-700/50 backdrop-blur-sm",children:[e.jsx(A,{value:"general",className:"data-[state=active]:bg-gradient-to-r data-[state=active]:from-violet-600 data-[state=active]:to-purple-600 data-[state=active]:text-white data-[state=active]:shadow-lg data-[state=active]:shadow-purple-500/30 hover:bg-slate-800/50 transition-all duration-300",children:"기본 설정"}),e.jsx(A,{value:"commission",className:"data-[state=active]:bg-gradient-to-r data-[state=active]:from-violet-600 data-[state=active]:to-purple-600 data-[state=active]:text-white data-[state=active]:shadow-lg data-[state=active]:shadow-purple-500/30 hover:bg-slate-800/50 transition-all duration-300",children:"커미션 설정"}),e.jsx(A,{value:"security",className:"data-[state=active]:bg-gradient-to-r data-[state=active]:from-violet-600 data-[state=active]:to-purple-600 data-[state=active]:text-white data-[state=active]:shadow-lg data-[state=active]:shadow-purple-500/30 hover:bg-slate-800/50 transition-all duration-300",children:"보안 설정"}),e.jsx(A,{value:"system",className:"data-[state=active]:bg-gradient-to-r data-[state=active]:from-violet-600 data-[state=active]:to-purple-600 data-[state=active]:text-white data-[state=active]:shadow-lg data-[state=active]:shadow-purple-500/30 hover:bg-slate-800/50 transition-all duration-300",children:"시스템 상태"})]}),e.jsx(D,{value:"general",className:"space-y-6",children:e.jsxs(b,{children:[e.jsxs(k,{children:[e.jsxs(C,{className:"flex items-center gap-2",children:[e.jsx(_e,{className:"h-5 w-5"}),"일반 설정"]}),e.jsx(E,{children:"시스템의 기본적인 설정을 관리합니다."})]}),e.jsxs(S,{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"system_name",children:"시스템 이름"}),e.jsx(n,{id:"system_name",value:x.system_name,onChange:s=>h(t=>({...t,system_name:s.target.value})),placeholder:"시스템 이름을 입력하세요"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"api_sync_interval",children:"API 동기화 주기 (초)"}),e.jsx(n,{id:"api_sync_interval",type:"number",value:x.api_sync_interval,onChange:s=>h(t=>({...t,api_sync_interval:parseInt(s.target.value)})),placeholder:"30"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"auto_approval_limit",children:"자동 승인 한도 (원)"}),e.jsx(n,{id:"auto_approval_limit",type:"number",value:x.auto_approval_limit,onChange:s=>h(t=>({...t,auto_approval_limit:parseInt(s.target.value)})),placeholder:"100000"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"session_timeout",children:"세션 타임아웃 (초)"}),e.jsx(n,{id:"session_timeout",type:"number",value:x.session_timeout,onChange:s=>h(t=>({...t,session_timeout:parseInt(s.target.value)})),placeholder:"1800"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"max_concurrent_image_downloads",children:"동시 이미지 다운로드 제한"}),e.jsx(n,{id:"max_concurrent_image_downloads",type:"number",min:"1",max:"10",value:x.max_concurrent_image_downloads,onChange:s=>h(t=>({...t,max_concurrent_image_downloads:parseInt(s.target.value)})),placeholder:"1"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"브라우저 메모리 최적화를 위해 동시 다운로드 수를 제한합니다."})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(r,{children:"알림 소리"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"새로운 알림 시 소리를 재생합니다."})]}),e.jsx(I,{checked:x.notification_sound,onCheckedChange:s=>h(t=>({...t,notification_sound:s}))})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(r,{children:"점검 모드"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"시스템을 점검 모드로 전환합니다."})]}),e.jsx(I,{checked:x.maintenance_mode,onCheckedChange:s=>h(t=>({...t,maintenance_mode:s}))})]})]}),e.jsx("div",{className:"flex justify-end pt-4",children:e.jsxs(N,{onClick:()=>z("일반",x),disabled:g,className:"flex items-center gap-2",children:[e.jsx(L,{className:"h-4 w-4"}),g?"저장 중...":"설정 저장"]})})]})]})}),e.jsxs(D,{value:"commission",className:"space-y-6",children:[e.jsxs(b,{children:[e.jsxs(k,{children:[e.jsxs(C,{className:"flex items-center gap-2",children:[e.jsx(Q,{className:"h-5 w-5"}),"파트너별 커미션 관리"]}),e.jsx(E,{children:"특정 파트너를 선택하여 개별 커미션을 설정합니다."})]}),e.jsxs(S,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs(r,{htmlFor:"partner-select",className:"flex items-center gap-2",children:[e.jsx(we,{className:"h-4 w-4"}),"파트너 선택"]}),e.jsxs(ge,{value:ae,onValueChange:de,children:[e.jsx(je,{id:"partner-select",children:e.jsx(fe,{placeholder:"커미션을 설정할 파트너를 선택하세요"})}),e.jsx(ve,{children:se.map(s=>e.jsx(ye,{value:s.id,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(F,{variant:"outline",className:"text-xs",children:s.partner_type==="head_office"?"대본사":s.partner_type==="main_office"?"본사":s.partner_type==="sub_office"?"부본사":s.partner_type==="distributor"?"총판":"매장"}),e.jsxs("span",{children:[s.nickname," (",s.username,")"]})]})},s.id))})]})]}),l?e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"p-4 bg-slate-800/30 rounded-lg border border-slate-700/50",children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-400 mb-1",children:"파트너명"}),e.jsx("p",{className:"font-medium text-white",children:l.nickname})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-400 mb-1",children:"등급"}),e.jsx(F,{children:l.partner_type==="head_office"?"대본사":l.partner_type==="main_office"?"본사":l.partner_type==="sub_office"?"부본사":l.partner_type==="distributor"?"총판":"매장"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-400 mb-1",children:"보유금"}),e.jsxs("p",{className:"font-mono text-green-400",children:[l.balance?.toLocaleString(),"원"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-400 mb-1",children:"상태"}),e.jsx(F,{variant:l.status==="active"?"default":"destructive",children:l.status==="active"?"활성":"비활성"})]})]})}),l.partner_type==="head_office"?e.jsx("div",{className:"p-4 bg-purple-50 dark:bg-purple-900/10 rounded-lg border border-purple-200 dark:border-purple-800",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(R,{className:"h-5 w-5 text-purple-500 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-purple-900 dark:text-purple-100 mb-1",children:"대본사 커미션"}),e.jsxs("p",{className:"text-sm text-purple-700 dark:text-purple-300",children:["대본사는 최상위 파트너로 모든 커미션이 ",e.jsx("strong",{children:"100%"}),"로 고정됩니다."]})]})]})}):e.jsx("div",{className:"p-4 bg-blue-50 dark:bg-blue-900/10 rounded-lg border border-blue-200 dark:border-blue-800",children:e.jsx("p",{className:"text-sm text-blue-700 dark:text-blue-300",children:"💡 상위 파트너의 커미션을 초과할 수 없습니다. 커미션 변경 시 정산에 즉시 반영됩니다."})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"partner_rolling",children:"롤링 커미션 (%)"}),e.jsx(n,{id:"partner_rolling",type:"number",step:"0.1",min:"0",max:"100",value:u.commission_rolling,onChange:s=>P(t=>({...t,commission_rolling:parseFloat(s.target.value)||0})),disabled:l.partner_type==="head_office",className:l.partner_type==="head_office"?"bg-muted":""}),e.jsx("p",{className:"text-xs text-muted-foreground",children:l.partner_type==="head_office"?"대본사 고정값":"회원 총 베팅액에 대한 커미션"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"partner_losing",children:"루징 커미션 (%)"}),e.jsx(n,{id:"partner_losing",type:"number",step:"0.1",min:"0",max:"100",value:u.commission_losing,onChange:s=>P(t=>({...t,commission_losing:parseFloat(s.target.value)||0})),disabled:l.partner_type==="head_office",className:l.partner_type==="head_office"?"bg-muted":""}),e.jsx("p",{className:"text-xs text-muted-foreground",children:l.partner_type==="head_office"?"대본사 고정값":"회원 순손실액에 대한 커미션"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"partner_fee",children:"환전 수수료 (%)"}),e.jsx(n,{id:"partner_fee",type:"number",step:"0.1",min:"0",max:"100",value:u.withdrawal_fee,onChange:s=>P(t=>({...t,withdrawal_fee:parseFloat(s.target.value)||0})),disabled:l.partner_type==="head_office",className:l.partner_type==="head_office"?"bg-muted":""}),e.jsx("p",{className:"text-xs text-muted-foreground",children:l.partner_type==="head_office"?"대본사 고정값":"환전 시 적용되는 수수료"})]})]}),e.jsx("div",{className:"flex justify-end pt-2",children:e.jsxs(N,{onClick:me,disabled:g||l.partner_type==="head_office",className:"flex items-center gap-2",children:[e.jsx(L,{className:"h-4 w-4"}),g?"저장 중...":"커미션 저장"]})})]}):e.jsxs("div",{className:"text-center py-12 text-slate-400",children:[e.jsx(Q,{className:"h-12 w-12 mx-auto mb-3 opacity-50"}),e.jsx("p",{children:"파트너를 선택하여 커미션을 관리하세요."})]})]})]}),e.jsxs(b,{children:[e.jsxs(k,{children:[e.jsxs(C,{className:"flex items-center gap-2",children:[e.jsx(X,{className:"h-5 w-5"}),"신규 파트너 기본 커미션"]}),e.jsx(E,{children:"신규 파트너 생성 시 자동 적용되는 기본 커미션을 설정합니다."})]}),e.jsxs(S,{className:"space-y-6",children:[e.jsx("div",{className:"p-4 bg-gradient-to-r from-blue-50 to-purple-50 dark:from-blue-900/10 dark:to-purple-900/10 rounded-lg border border-blue-200 dark:border-blue-800",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(X,{className:"h-5 w-5 text-blue-500 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-blue-900 dark:text-blue-100 mb-2",children:"기본 커미션 안내"}),e.jsxs("ul",{className:"text-sm text-blue-700 dark:text-blue-300 space-y-1",children:[e.jsxs("li",{children:["• ",e.jsx("strong",{children:"신규 파트너"}),": 파트너 생성 시 이 값이 자동으로 적용됩니다."]}),e.jsxs("li",{children:["• ",e.jsx("strong",{children:"개별 설정"}),": 위 파트너별 커미션 관리에서 개별 수정 가능합니다."]}),e.jsxs("li",{children:["• ",e.jsx("strong",{children:"대본사"}),": 대본사는 자동으로 100%로 설정됩니다."]})]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"default_rolling_commission",children:"기본 롤링 커미션 (%)"}),e.jsx(n,{id:"default_rolling_commission",type:"number",step:"0.1",value:j.default_rolling_commission,onChange:s=>v(t=>({...t,default_rolling_commission:parseFloat(s.target.value)})),placeholder:"0.5"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"회원 총 베팅액에 대한 커미션 비율"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"default_losing_commission",children:"기본 루징 커미션 (%)"}),e.jsx(n,{id:"default_losing_commission",type:"number",step:"0.1",value:j.default_losing_commission,onChange:s=>v(t=>({...t,default_losing_commission:parseFloat(s.target.value)})),placeholder:"5.0"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"회원 순손실액(베팅-당첨)에 대한 커미션 비율"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"default_withdrawal_fee",children:"기본 환전 수수료 (%)"}),e.jsx(n,{id:"default_withdrawal_fee",type:"number",step:"0.1",value:j.default_withdrawal_fee,onChange:s=>v(t=>({...t,default_withdrawal_fee:parseFloat(s.target.value)})),placeholder:"1.0"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"회원 환전 시 적용되는 수수료 비율"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"min_withdrawal_amount",children:"최소 출금 금액 (원)"}),e.jsx(n,{id:"min_withdrawal_amount",type:"number",value:j.min_withdrawal_amount,onChange:s=>v(t=>({...t,min_withdrawal_amount:parseInt(s.target.value)})),placeholder:"10000"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"max_withdrawal_amount",children:"최대 출금 금액 (원)"}),e.jsx(n,{id:"max_withdrawal_amount",type:"number",value:j.max_withdrawal_amount,onChange:s=>v(t=>({...t,max_withdrawal_amount:parseInt(s.target.value)})),placeholder:"1000000"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"daily_withdrawal_limit",children:"일일 출금 한도 (원)"}),e.jsx(n,{id:"daily_withdrawal_limit",type:"number",value:j.daily_withdrawal_limit,onChange:s=>v(t=>({...t,daily_withdrawal_limit:parseInt(s.target.value)})),placeholder:"5000000"})]})]}),e.jsx("div",{className:"flex justify-end pt-4",children:e.jsxs(N,{onClick:()=>z("커미션",j),disabled:g,className:"flex items-center gap-2",children:[e.jsx(L,{className:"h-4 w-4"}),g?"저장 중...":"설정 저장"]})})]})]})]}),e.jsx(D,{value:"security",className:"space-y-6",children:e.jsxs(b,{children:[e.jsxs(k,{children:[e.jsxs(C,{className:"flex items-center gap-2",children:[e.jsx(R,{className:"h-5 w-5"}),"보안 설정"]}),e.jsx(E,{children:"시스템 보안 관련 설정을 관리합니다."})]}),e.jsxs(S,{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"password_min_length",children:"최소 비밀번호 길이"}),e.jsx(n,{id:"password_min_length",type:"number",value:p.password_min_length,onChange:s=>y(t=>({...t,password_min_length:parseInt(s.target.value)})),placeholder:"8"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"max_login_attempts",children:"최대 로그인 시도 횟수"}),e.jsx(n,{id:"max_login_attempts",type:"number",value:x.max_login_attempts,onChange:s=>h(t=>({...t,max_login_attempts:parseInt(s.target.value)})),placeholder:"5"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"login_log_retention_days",children:"로그인 로그 보관 일수"}),e.jsx(n,{id:"login_log_retention_days",type:"number",value:p.login_log_retention_days,onChange:s=>y(t=>({...t,login_log_retention_days:parseInt(s.target.value)})),placeholder:"90"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(r,{children:"특수문자 필수"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"비밀번호에 특수문자 포함을 필수로 합니다."})]}),e.jsx(I,{checked:p.password_require_special,onCheckedChange:s=>y(t=>({...t,password_require_special:s}))})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(r,{children:"IP 화이트리스트"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"허용된 IP에서만 접속을 허용합니다."})]}),e.jsx(I,{checked:p.ip_whitelist_enabled,onCheckedChange:async s=>{y(t=>({...t,ip_whitelist_enabled:s}));try{const{error:t}=await o.from("system_settings").upsert({setting_key:"ip_whitelist_enabled",setting_value:s.toString(),setting_type:"boolean",partner_level:f.level,description:"IP 화이트리스트 활성화"},{onConflict:"setting_key"});if(t)throw t;i.success(s?"IP 화이트리스트가 활성화되었습니다.":"IP 화이트리스트가 비활성화되었습니다.")}catch(t){console.error("설정 저장 실패:",t),i.error("설정 저장에 실패했습니다.")}}})]}),p.ip_whitelist_enabled&&e.jsxs("div",{className:"p-4 border rounded-lg bg-muted/10 space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(R,{className:"h-4 w-4 text-blue-500"}),e.jsx(r,{className:"text-sm font-medium",children:"허용 IP 주소 관리"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(n,{placeholder:"IP 주소 입력 (예: 192.168.1.1)",value:q,onChange:s=>$(s.target.value),onKeyDown:s=>{s.key==="Enter"&&(s.preventDefault(),K())}}),e.jsxs(N,{onClick:K,size:"sm",children:[e.jsx(be,{className:"h-4 w-4 mr-1"}),"추가"]})]}),w.length>0?e.jsxs("div",{className:"space-y-2",children:[e.jsxs(r,{className:"text-xs text-muted-foreground",children:["등록된 IP 주소 (",w.length,"개)"]}),e.jsx("div",{className:"max-h-40 overflow-y-auto space-y-1",children:w.map((s,t)=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-background rounded border",children:[e.jsx("code",{className:"text-sm",children:s}),e.jsx(N,{onClick:()=>ne(s),variant:"ghost",size:"sm",className:"h-6 px-2",children:e.jsx(ke,{className:"h-3 w-3"})})]},t))})]}):e.jsx("div",{className:"text-center py-4 text-sm text-muted-foreground",children:"등록된 IP 주소가 없습니다. IP를 추가하세요."}),e.jsxs("div",{className:"text-xs text-yellow-600 dark:text-yellow-500 flex items-start gap-2",children:[e.jsx(Ce,{className:"h-4 w-4 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"주의사항:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 mt-1",children:[e.jsx("li",{children:"IP 화이트리스트가 활성화되면 등록된 IP에서만 접속 가능합니다."}),e.jsx("li",{children:"본인 IP를 먼저 등록한 후 활성화하세요."}),e.jsx("li",{children:"잘못된 설정 시 접속이 차단될 수 있습니다."})]})]})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(r,{children:"2단계 인증"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"로그인 시 2단계 인증을 요구합니다."})]}),e.jsx(I,{checked:p.two_factor_enabled,onCheckedChange:s=>y(t=>({...t,two_factor_enabled:s}))})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(r,{children:"감사 로그"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"모든 관리자 행동을 로그로 기록합니다."})]}),e.jsx(I,{checked:p.audit_log_enabled,onCheckedChange:s=>y(t=>({...t,audit_log_enabled:s}))})]})]}),e.jsx("div",{className:"flex justify-end pt-4",children:e.jsxs(N,{onClick:()=>z("보안",p),disabled:g,className:"flex items-center gap-2",children:[e.jsx(L,{className:"h-4 w-4"}),g?"저장 중...":"설정 저장"]})})]})]})}),e.jsx(D,{value:"system",className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(b,{children:[e.jsx(k,{children:e.jsxs(C,{className:"flex items-center gap-2",children:[e.jsx(Se,{className:"h-5 w-5"}),"시스템 상태"]})}),e.jsx(S,{className:"space-y-4",children:m&&e.jsxs(e.Fragment,{children:[e.jsx(G,{status:m.database_status,label:"데이터베이스"}),e.jsx(G,{status:m.api_status,label:"외부 API"}),e.jsx(G,{status:m.websocket_status,label:"WebSocket"})]})})]}),e.jsxs(b,{children:[e.jsx(k,{children:e.jsxs(C,{className:"flex items-center gap-2",children:[e.jsx(Ne,{className:"h-5 w-5"}),"시스템 정보"]})}),e.jsx(S,{className:"space-y-4",children:m&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"활성 사용자"}),e.jsxs(F,{children:[m.active_users,"명"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"시스템 업타임"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:m.system_uptime})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"메모리 사용률"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[m.memory_usage,"%"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"CPU 사용률"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[m.cpu_usage,"%"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"마지막 백업"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:m.last_backup})]})]})})]})]})})]})]})}export{We as SystemSettings,We as default};
